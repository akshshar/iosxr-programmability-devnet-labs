# Enabling Model-Driven Telemetry on the Router

<div style="margin: 2em 0 !important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #fdefef;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);"><h3>Resetting router configurations</h3><p> Use this section to reset your router configurations to their base config when they're just launched using the devnet sandbox UI. **If you have just reserved the devnet sandbox and this is your first lab, you will NOT need to reset the router configurations and you can skip this Red box :)**. However, if you've been running multiple labs with the same reservation, you might want to clean the palate before proceeding to make sure all the following instructions match your experience with the sandbox environment.<br/><br/> To reset the configuration, first connect to the devbox:<br/><p style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #e6f2f7;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);">**Username**: admin<br/>**Password**: admin<br/>**SSH port**: 2211</p><pre><code>Laptop-terminal:$ ssh -p 2211 admin@10.10.20.170
admin@10.10.20.170's password:
Last login: Sun Aug 26 17:34:49 2018 from 192.168.122.1
admin@devbox:~$
admin@devbox:~$
</code></pre>Clone the <https://github.com/akshshar/iosxr-programmability-devnet-labs-code> github repo and drop into the `reset_setup` directory:<pre><code>admin@devbox:~$
admin@devbox:~$ git clone https://github.com/akshshar/iosxr-programmability-devnet-labs-code
Cloning into 'iosxr-programmability-devnet-labs-code'...
remote: Counting objects: 38, done.
remote: Compressing objects: 100% (27/27), done.
remote: Total 38 (delta 5), reused 33 (delta 3), pack-reused 0
Unpacking objects: 100% (38/38), done.
Checking connectivity... done.
admin@devbox:~$
admin@devbox:~$
admin@devbox:~$ cd iosxr-programmability-devnet-labs-code/reset_setup/
admin@devbox:reset_setup$ ls
configs  connection_details.sh  reset_setup.sh
admin@devbox:reset_setup$
</code></pre>Now run `./reset_setup.sh` and your router configurations should get reset:<pre><code>admin@devbox:reset_setup$ ./reset_setup.sh

Starting Reset process for Router r1....
Connection to 10.10.20.170 closed.
Configuration done!
Verifying running configuration...
Connection to 10.10.20.170 closed.

Configuration Successful!


Starting Reset process for Router r2....
Connection to 10.10.20.170 closed.
Configuration done!
Verifying running configuration...
Connection to 10.10.20.170 closed.
Configuration Successful!

admin@devbox:reset_setup$
</code></pre><p style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #eff9ef;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);">And with that, you're all set to start this lab!</p></p></div>



## Configure Model-Driven Telemetry

In this lab, we intend to enable IPv6 on b2b interfaces on the two routers (`r1` and `r2`) and stream IPv6 neighbor information to a connected client over gRPC.   

We will construct a `dial-in` Telemetry collector/client wherein the client initiates a connection to the router and then subscribes to a pre-configured subscription on the router.    

### Set up IPv6 Neighbors

To start off, let's enable IPv6 and configure IPv6 addresses on the b2b interfaces of r1 and r2.


#### Configure IPv6 on router r1  

Connect to router `r1`:  

<p style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #e6f2f7;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);">**Username**: admin<br/>**Password**: admin<br/>**SSH port**: 2221<br/>**IP**: 10.10.20.170
</p>  


```
Laptop-terminal:$ ssh -p 2221 admin@10.10.20.170


--------------------------------------------------------------------------
  Router 1 (Cisco IOS XR Sandbox)
--------------------------------------------------------------------------


Password:


RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#

```

Apply the following configuration on router `r1`:

```
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#conf t
Mon Sep  3 09:00:33.672 UTC
RP/0/RP0/CPU0:r1(config)#interface GigabitEthernet 0/0/0/0
RP/0/RP0/CPU0:r1(config-if)#ipv6 enable
RP/0/RP0/CPU0:r1(config-if)#ipv6 address 1010:1010::10/64
RP/0/RP0/CPU0:r1(config-if)#no shut
RP/0/RP0/CPU0:r1(config-if)#      
RP/0/RP0/CPU0:r1(config-if)#
RP/0/RP0/CPU0:r1(config-if)#exit
RP/0/RP0/CPU0:r1(config)#
RP/0/RP0/CPU0:r1(config)#interface GigabitEthernet 0/0/0/1
RP/0/RP0/CPU0:r1(config-if)#ipv6 enable                      
RP/0/RP0/CPU0:r1(config-if)#ipv6 address 2020:2020::10/64    
RP/0/RP0/CPU0:r1(config-if)#no shut
RP/0/RP0/CPU0:r1(config-if)#commit
Mon Sep  3 09:01:59.484 UTC
RP/0/RP0/CPU0:r1(config-if)#
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#show  configuration commit changes last 1
Mon Sep  3 09:02:08.867 UTC
Building configuration...
!! IOS XR Configuration version = 6.4.1
interface GigabitEthernet0/0/0/0
 ipv6 address 1010:1010::10/64
 ipv6 enable
 no shutdown
!
interface GigabitEthernet0/0/0/1
 ipv6 address 2020:2020::10/64
 ipv6 enable
 no shutdown
!
end

RP/0/RP0/CPU0:r1#

```

#### Configure IPv6 on router r2

Similarly, connect to router `r2`:

<p style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #e6f2f7;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);">**Username**: admin<br/>**Password**: admin<br/>**SSH port**: 2231<br/>**IP**: 10.10.20.170
</p>  


```
Laptop-terminal:$ ssh -p 2231 admin@10.10.20.170


--------------------------------------------------------------------------
  Router 2 (Cisco IOS XR Sandbox)
--------------------------------------------------------------------------


Password:


RP/0/RP0/CPU0:r2#
RP/0/RP0/CPU0:r2#

```

Apply the following configuration to router `r2`:

```
RP/0/RP0/CPU0:r2#
RP/0/RP0/CPU0:r2#conf t
Mon Sep  3 09:04:32.472 UTC
RP/0/RP0/CPU0:r2(config)#interface GigabitEthernet 0/0/0/0
RP/0/RP0/CPU0:r2(config-if)#ipv6 enable
RP/0/RP0/CPU0:r2(config-if)#ipv6 address 1010:1010::20/64
RP/0/RP0/CPU0:r2(config-if)#no shut
RP/0/RP0/CPU0:r2(config-if)#exit
RP/0/RP0/CPU0:r2(config)#interface GigabitEthernet 0/0/0/1
RP/0/RP0/CPU0:r2(config-if)#ipv6 enable
RP/0/RP0/CPU0:r2(config-if)#ipv6 address 2020:2020::20/64
RP/0/RP0/CPU0:r2(config-if)#no shut
RP/0/RP0/CPU0:r2(config-if)#commit
Mon Sep  3 09:05:37.371 UTC
RP/0/RP0/CPU0:r2(config-if)#
RP/0/RP0/CPU0:r2#
RP/0/RP0/CPU0:r2#show  configuration commit changes last 1
Mon Sep  3 09:05:51.846 UTC
Building configuration...
!! IOS XR Configuration version = 6.4.1
interface GigabitEthernet0/0/0/0
 ipv6 address 1010:1010::20/64
 ipv6 enable
 no shutdown
!
interface GigabitEthernet0/0/0/1
 ipv6 address 2020:2020::20/64
 ipv6 enable
 no shutdown
!
end

RP/0/RP0/CPU0:r2#

```


#### Bring up IPv6 neighbors

IPv6 Neighbor Discovery (ND) works much the same way as ARP. Neighbor discovery messages are not sent out until traffic flow for a particular IPv6 destination needs to traverse the IPv6 enabled interface.  
So if we dump the `ipv6 neighbor` information on the two routers, we don't notice any reachable neighbors just yet.



Router r1:

```
RP/0/RP0/CPU0:r1#show  ipv6 neighbors
Mon Sep  3 09:13:17.796 UTC
IPv6 Address                             Age  Link-layer Add State Interface            Location
[Mcast adjacency]                           - 0000.0000.0000 REACH Gi0/0/0/0            0/0/CPU0       
[Mcast adjacency]                           - 0000.0000.0000 REACH Gi0/0/0/1            0/0/CPU0       
RP/0/RP0/CPU0:r1#
```

Router r2:

```
RP/0/RP0/CPU0:r2#show  ipv6 neighbors
Mon Sep  3 09:12:52.780 UTC
IPv6 Address                             Age  Link-layer Add State Interface            Location
[Mcast adjacency]                           - 0000.0000.0000 REACH Gi0/0/0/0            0/0/CPU0       
[Mcast adjacency]                           - 0000.0000.0000 REACH Gi0/0/0/1            0/0/CPU0       
RP/0/RP0/CPU0:r2#
```  

#### Ping the reachable Neighbors

We'll use pings (icmpv6) as the trigger to generate IPv6 ND messages and establish neighbors dynamically:  

On router `r1`:

```
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#ping 1010:1010::20
Mon Sep  3 09:25:45.079 UTC
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 1010:1010::20, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 95/125/231 ms
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#ping 2020:2020::20
Mon Sep  3 09:25:53.627 UTC
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 2020:2020::20, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 97/125/214 ms
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#
```

#### Verify neighbors are up  

The IPv6 neighbors should now be up!

```
RP/0/RP0/CPU0:r1#show  ipv6 neighbors
Mon Sep  3 09:26:07.306 UTC
IPv6 Address                             Age  Link-layer Add State Interface            Location
1010:1010::20                            21   5254.0093.8ab0 REACH Gi0/0/0/0            0/0/CPU0       
fe80::5054:ff:fe93:8ab0                  11   5254.0093.8ab0 REACH Gi0/0/0/0            0/0/CPU0       
[Mcast adjacency]                           - 0000.0000.0000 REACH Gi0/0/0/0            0/0/CPU0       
2020:2020::20                            13   5254.0093.8ab1 REACH Gi0/0/0/1            0/0/CPU0       
fe80::5054:ff:fe93:8ab1                  2    5254.0093.8ab1 REACH Gi0/0/0/1            0/0/CPU0       
[Mcast adjacency]                           - 0000.0000.0000 REACH Gi0/0/0/1            0/0/CPU0       
RP/0/RP0/CPU0:r1#

```


### Configure Telemetry to Stream IPv6 neighbor information

The IPv6 neighbors displayed using `show ipv6 neighbors` can be streamed using the IPv6-ND oper YANG model in IOS-XR.  

<div style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #fdefef;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);"> The Yang models for IOS-XR per release can be found on Github here: <br/>
<blockquote>
<https://github.com/YangModels/yang/tree/master/vendor/cisco/xr>
</blockquote>  

In this lab we're working with IOS-XR release `6.4.1`:  

<p><pre><code>
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#show  version
Mon Sep  3 09:46:31.320 UTC

Cisco IOS XR Software, Version 6.4.1
Copyright (c) 2013-2017 by Cisco Systems, Inc.

Build Information:
 Built By     : nkhai
 Built On     : Wed Mar 28 19:20:20 PDT 2018
 Build Host   : iox-lnx-090
 Workspace    : /auto/srcarchive14/prod/6.4.1/xrv9k/ws
 Version      : 6.4.1
 Location     : /opt/cisco/XR/packages/

cisco IOS-XRv 9000 () processor
System uptime is 2 hours, 28 minutes

RP/0/RP0/CPU0:r1#
</code></pre></p>  

The required Yang models for this release are thus available here:
<blockquote>
<https://github.com/YangModels/yang/tree/master/vendor/cisco/xr/641>
</blockquote>  
</div>

### Figure out the Yang Model/Path to use

The Yang model we're interested in is `Cisco-IOS-XR-ipv6-nd-oper.yang`, located here:
><https://github.com/YangModels/yang/blob/master/vendor/cisco/xr/641/Cisco-IOS-XR-ipv6-nd-oper.yang>  

The easiest way to understand the information available within the Yang model is to display the YANG model in a tree format using a tool called `pyang`.  

For this purpose, connect to the devbox:

<p style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #e6f2f7;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);">**Username**: admin<br/>**Password**: admin<br/>**SSH port**: 2211<br/>**IP**: 10.10.20.170
</p>  

```
Laptop-terminal:$ ssh -p 2211 admin@10.10.20.170
admin@10.10.20.170's password:
Last login: Mon Sep  3 01:28:30 2018 from 192.168.122.1
admin@devbox:~$
admin@devbox:~$

```

Clone the Yang git repo:  


```
admin@devbox:~$ git clone https://github.com/YangModels/yang
Cloning into 'yang'...
remote: Counting objects: 21847, done.
remote: Compressing objects: 100% (218/218), done.
remote: Total 21847 (delta 512), reused 709 (delta 505), pack-reused 21124
Receiving objects: 100% (21847/21847), 42.52 MiB | 13.17 MiB/s, done.
Resolving deltas: 100% (16807/16807), done.
Checking connectivity... done.
Checking out files: 100% (20153/20153), done.
admin@devbox:~$
admin@devbox:~$
admin@devbox:~$ cd yang/vendor/cisco/xr/641/
admin@devbox:641$ pwd
/home/admin/yang/vendor/cisco/xr/641
admin@devbox:641$

```


Dump the `Cisco-IOS-XR-ipv6-nd-oper.yang` model in a tree format:

```
admin@devbox:641$ pyang -f tree Cisco-IOS-XR-ipv6-nd-oper.yang
module: Cisco-IOS-XR-ipv6-nd-oper
   +--ro ipv6-node-discovery
      +--ro nodes
         +--ro node* [node-name]
            +--ro neighbor-interfaces
            |  +--ro neighbor-interface* [interface-name]
            |     +--ro host-addresses
            |     |  +--ro host-address* [host-address]
            |     |     +--ro host-address              inet:ipv6-address-no-zone
            |     |     +--ro last-reached-time
            |     |     |  +--ro seconds?   uint32
            |     |     +--ro reachability-state?       Ipv6-nd-sh-state
            |     |     +--ro link-layer-address?       yang:mac-address
            |     |     +--ro encapsulation?            Ipv6-nd-media-encap
            |     |     +--ro selected-encapsulation?   Ipv6-nd-media-encap
            |     |     +--ro origin-encapsulation?     Ipv6-nd-neighbor-origin
            |     |     +--ro interface-name?           string
            |     |     +--ro location?                 xr:Node-id
            |     |     +--ro is-router?                boolean
            |     |     +--ro serg-flags?               uint32
            |     |     +--ro vrfid?                    uint32
            |     +--ro interface-name    xr:Interface-name
            +--ro neighbor-summary
            |  +--ro multicast
            |  |  +--ro incomplete-entries?          uint32
            |  |  +--ro reachable-entries?           uint32
            |  |  +--ro stale-entries?               uint32
            |  |  +--ro delayed-entries?             uint32
            |  |  +--ro probe-entries?               uint32
            |  |  +--ro deleted-entries?             uint32
            |  |  +--ro subtotal-neighbor-entries?   uint32
            |  +--ro static
            |  |  +--ro incomplete-entries?          uint32
            |  |  +--ro reachable-entries?           uint32
            |  |  +--ro stale-entries?               uint32
            |  |  +--ro delayed-entries?             uint32
            |  |  +--ro probe-entries?               uint32
            |  |  +--ro deleted-entries?             uint32
            |  |  +--ro subtotal-neighbor-entries?   uint32
            |  +--ro dynamic
            |  |  +--ro incomplete-entries?          uint32
            |  |  +--ro reachable-entries?           uint32
            |  |  +--ro stale-entries?               uint32
            |  |  +--ro delayed-entries?             uint32
            |  |  +--ro probe-entries?               uint32
            |  |  +--ro deleted-entries?             uint32
            |  |  +--ro subtotal-neighbor-entries?   uint32
            |  +--ro total-neighbor-entries?   uint32
            +--ro bundle-nodes
            |  +--ro bundle-node* [node-name]
            |     +--ro node-name                   xr:Node-id
            |     +--ro age
            |     |  +--ro seconds?   uint32
            |     +--ro group-id?                   uint32
            |     +--ro process-name?               string
            |     +--ro sent-sequence-number?       uint32
            |     +--ro received-sequence-number?   uint32
            |     +--ro state?                      Ipv6-nd-bndl-state
            |     +--ro state-changes?              uint32
            |     +--ro sent-packets?               uint32
            |     +--ro received-packets?           uint32
            +--ro bundle-interfaces
            |  +--ro bundle-interface* [interface-name]
            |     +--ro interface-name           xr:Interface-name
            |     +--ro nd-parameters
            |     |  +--ro is-dad-enabled?               boolean
            |     |  +--ro dad-attempts?                 uint32
            |     |  +--ro is-icm-pv6-redirect?          boolean
            |     |  +--ro is-dhcp-managed?              boolean
            |     |  +--ro is-route-address-managed?     boolean
            |     |  +--ro is-suppressed?                boolean
            |     |  +--ro send-unicast-ra?              boolean
            |     |  +--ro nd-retransmit-interval?       uint32
            |     |  +--ro nd-min-transmit-interval?     uint32
            |     |  +--ro nd-max-transmit-interval?     uint32
            |     |  +--ro nd-advertisement-lifetime?    uint32
            |     |  +--ro nd-reachable-time?            uint32
            |     |  +--ro nd-cache-limit?               uint32
            |     |  +--ro complete-protocol-count?      uint32
            |     |  +--ro complete-glean-count?         uint32
            |     |  +--ro incomplete-protocol-count?    uint32
            |     |  +--ro incomplete-glean-count?       uint32
            |     |  +--ro dropped-protocol-req-count?   uint32
            |     |  +--ro dropped-glean-req-count?      uint32
            |     +--ro local-address
            |     |  +--ro ipv6-address?     inet:ipv6-address
            |     |  +--ro valid-lifetime?   uint32
            |     |  +--ro pref-lifetime?    uint32
            |     +--ro parent-interface-name?   xr:Interface-name
            |     +--ro iftype?                  uint32
            |     +--ro mtu?                     uint32
            |     +--ro etype?                   uint32
            |     +--ro vlan-tag?                uint16
            |     +--ro mac-addr-size?           uint32
            |     +--ro mac-addr?                yang:mac-address
            |     +--ro is-interface-enabled?    boolean
            |     +--ro is-ipv6-enabled?         boolean
            |     +--ro is-mpls-enabled?         boolean
            |     +--ro member-link*             uint32
            |     +--ro global-address*
            |     |  +--ro ipv6-address?     inet:ipv6-address
            |     |  +--ro valid-lifetime?   uint32
            |     |  +--ro pref-lifetime?    uint32
            |     +--ro member-node*
            |        +--ro node-name?     xr:Node-id
            |        +--ro total-links?   uint32
            +--ro interfaces
            |  +--ro interface* [interface-name]
            |     +--ro interface-name                xr:Interface-name
            |     +--ro is-dad-enabled?               boolean
            |     +--ro dad-attempts?                 uint32
            |     +--ro is-icm-pv6-redirect?          boolean
            |     +--ro is-dhcp-managed?              boolean
            |     +--ro is-route-address-managed?     boolean
            |     +--ro is-suppressed?                boolean
            |     +--ro send-unicast-ra?              boolean
            |     +--ro nd-retransmit-interval?       uint32
            |     +--ro nd-min-transmit-interval?     uint32
            |     +--ro nd-max-transmit-interval?     uint32
            |     +--ro nd-advertisement-lifetime?    uint32
            |     +--ro nd-reachable-time?            uint32
            |     +--ro nd-cache-limit?               uint32
            |     +--ro complete-protocol-count?      uint32
            |     +--ro complete-glean-count?         uint32
            |     +--ro incomplete-protocol-count?    uint32
            |     +--ro incomplete-glean-count?       uint32
            |     +--ro dropped-protocol-req-count?   uint32
            |     +--ro dropped-glean-req-count?      uint32
            +--ro nd-virtual-routers
            |  +--ro nd-virtual-router* [interface-name]
            |     +--ro interface-name        xr:Interface-name
            |     +--ro local-address
            |     |  +--ro ipv6-address?     inet:ipv6-address
            |     |  +--ro valid-lifetime?   uint32
            |     |  +--ro pref-lifetime?    uint32
            |     +--ro link-layer-address?   yang:mac-address
            |     +--ro context?              uint32
            |     +--ro state?                Ipv6-nd-sh-vr-state
            |     +--ro flags?                Ipv6-nd-sh-vr-flags
            |     +--ro vr-gl-addr-ct?        uint32
            |     +--ro vr-global-address*
            |        +--ro ipv6-address?     inet:ipv6-address
            |        +--ro valid-lifetime?   uint32
            |        +--ro pref-lifetime?    uint32
            +--ro slaac-interfaces
            |  +--ro slaac-interface* [interface-name]
            |     +--ro router-advert-detail
            |     |  +--ro idb?   xr:Interface-name
            |     |  +--ro ra*
            |     |     +--ro elapsed-ra-time
            |     |     |  +--ro seconds?   uint32
            |     |     +--ro reachable-time
            |     |     |  +--ro seconds?   uint32
            |     |     +--ro retrans-time
            |     |     |  +--ro seconds?   uint32
            |     |     +--ro address?           inet:ipv6-address
            |     |     +--ro hops?              uint32
            |     |     +--ro flags?             uint32
            |     |     +--ro life-time?         uint32
            |     |     +--ro mtu?               uint32
            |     |     +--ro err-msg?           boolean
            |     |     +--ro vrf-id?            uint32
            |     |     +--ro u6-tbl-id?         uint32
            |     |     +--ro rib-protoid?       uint16
            |     |     +--ro default-router?    boolean
            |     |     +--ro reachability?      uint32
            |     |     +--ro prefix-q*
            |     |        +--ro prefix-address?        inet:ipv6-address
            |     |        +--ro eui64?                 inet:ipv6-address
            |     |        +--ro valid-life-time?       uint32
            |     |        +--ro preferred-life-time?   uint32
            |     |        +--ro prefix-len?            uint32
            |     |        +--ro flags?                 uint32
            |     |        +--ro pfx-flags?             uint32
            |     +--ro interface-name          xr:Interface-name
            +--ro node-name              xr:Node-id
admin@devbox:641$

```

From the above dump, it becomes fairly clear that we intend to extract the following set of nodes from the model to match the information in the `show ipv6 neighbors` output:  

<p><pre><code>
<mark>module: Cisco-IOS-XR-ipv6-nd-oper</mark>
   <mark>+--ro ipv6-node-discovery</mark>
      <mark>+--ro nodes</mark>
         <mark>+--ro node* [node-name]</mark>
            <mark>+--ro neighbor-interfaces</mark>
            <mark>|  +--ro neighbor-interface* [interface-name]</mark>
            <mark>|     +--ro host-addresses</mark>
            <mark>|     |  +--ro host-address* [host-address]</mark>
            |     |     +--ro host-address              inet:ipv6-address-no-zone
            |     |     +--ro last-reached-time
            |     |     |  +--ro seconds?   uint32
            |     |     +--ro reachability-state?       Ipv6-nd-sh-state
            |     |     +--ro link-layer-address?       yang:mac-address
            |     |     +--ro encapsulation?            Ipv6-nd-media-encap
            |     |     +--ro selected-encapsulation?   Ipv6-nd-media-encap
            |     |     +--ro origin-encapsulation?     Ipv6-nd-neighbor-origin
            |     |     +--ro interface-name?           string
            |     |     +--ro location?                 xr:Node-id
            |     |     +--ro is-router?                boolean
            |     |     +--ro serg-flags?               uint32
            |     |     +--ro vrfid?                    uint32</mark>

</code></pre></p>


### Setting up the Telemetry configuration  

The container path that we need to set up as part of the Telemetry configuration is highlighted above.
On the router, this becomes the following `sensor-path`:

```
!
telemetry model-driven
 sensor-group IPV6Neighbor
  sensor-path Cisco-IOS-XR-ipv6-nd-oper:ipv6-node-discovery/nodes/node/neighbor-interfaces/neighbor-interface/host-addresses/host-address
 !
```

Creating a subscription out of this path to stream the data every 15 seconds, we get the following additional configuration:

<p><pre><code>
telemetry model-driven
 sensor-group IPV6Neighbor
  sensor-path Cisco-IOS-XR-ipv6-nd-oper:ipv6-node-discovery/nodes/node/neighbor-interfaces/neighbor-interface/host-addresses/host-address
 !
 <mark>subscription IPV6
  sensor-group-id IPV6Neighbor sample-interval 15000</mark>
 !
!
</code></pre></p>

Finally, we intend to use `dial-in` as a method for the Telemetry client/collector to connect to the router. This implies the client will authenticate over gRPC and initiate a connection to the router before subscribing to the Telemetry stream.  


### Enable gRPC on port 57777

#### Disable TLS under grpc

The code we intend to write will not utilize TLS encryption: we will reserve that scenario for another lab. So to start off without any encryption, configure `no-tls` under the gRPC config mode. In the `show grpc status` output, TLS should get set to `disabled`.

```
RP/0/RP0/CPU0:r1#conf t
Mon Aug 27 02:03:23.037 UTC
RP/0/RP0/CPU0:r1(config)#grpc
RP/0/RP0/CPU0:r1(config-grpc)#no-tls
RP/0/RP0/CPU0:r1(config-grpc)#commit
Mon Aug 27 02:03:30.897 UTC
RP/0/RP0/CPU0:r1(config-grpc)#
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#show grpc status
Mon Aug 27 02:04:06.558 UTC
*************************show gRPC status**********************
---------------------------------------------------------------
transport                       :     grpc
access-family                   :     tcp4
TLS                             :     disabled
trustpoint                      :     NotSet
listening-port                  :     57777
max-request-per-user            :     10
max-request-total               :     128
vrf-socket-ns-path              :     global-vrf
_______________________________________________________________
*************************End of showing status*****************
RP/0/RP0/CPU0:r1#

```


#### Verify final gRPC configuration

At the end, for this lab, your final gRPC configuration on Router r1 should look something like:  

```
RP/0/RP0/CPU0:r1#show  running-config grpc
Mon Aug 27 02:03:35.837 UTC
grpc
 port 57777
 no-tls
 !
!

RP/0/RP0/CPU0:r1#

```


#### Check that the gRPC port is operational

The gRPC server runs as a Linux process on the IOS-XR system. It therefore opens up a port in the kernel on the Router Processor (RP) module.   
This port also gets programmed into the LPTS (Local Packet Transport Services) component of IOS-XR that maintains a distributed table across all nodes (RP, Linecards) of the Router to enable clients to connect to the gRPC port over distributed line card ports along with the Management Port.  

We can check these states as shown below:  

##### gRPC port in the RP kernel  

```
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#bash
Sat Sep  1 23:54:31.555 UTC
[r1:~]$
[r1:~]$
[r1:~]$ netstat -nlp | grep 57777
tcp        0      0 0.0.0.0:57777           0.0.0.0:*               LISTEN      10581/emsd      
[r1:~]$

```

##### gRPC port in LPTS

```
RP/0/RP0/CPU0:r1#show  lpts  pifib brief  | i 57777
Sat Sep  1 23:55:25.425 UTC
 IPv4       default  TCP    any          0/RP0/CPU0   any,57777 any
RP/0/RP0/CPU0:r1#

```

#### Verify Port forwarding to the gRPC server

As described in the earlier section, port 57777 of the router `r1` is forwarded to the port `57021` over the IP address: `10.10.20.170`.  Once the above configurations and verifications are done, try using telnet on the devbox to verify that the tcp port is open.
If the telnet session opens up, you're good. Else it will close down immediately.   

<p style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #fdefef;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);">
**Tip**: Using Telnet to verify the connectivity is better than using netcat(nc) which would report the port is open (as a result of port forwarding) even if an actual session cannot be established.
</p>

<p style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #e6f2f7;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);">**Username**: admin<br/>**Password**: admin<br/>**SSH port**: 2211
</p>  

```bash
Laptop-terminal:$ ssh -p 2211 admin@10.10.20.170
admin@devbox:tutorial$
admin@devbox:tutorial$ admin@devbox:tutorial$ telnet 10.10.20.170 57021
Trying 10.10.20.170...
Connected to 10.10.20.170.
Escape character is '^]'.



telnet> q
Connection closed.
admin@devbox:tutorial$
```

You can also check that the port `57777` is open on the internal IP address (behind the NAT) of the Router `r1`'s Management address: `192.168.122.21`.


```
admin@devbox:tutorial$ telnet 192.168.122.21 57777
Trying 192.168.122.21...
Connected to 192.168.122.21.
Escape character is '^]'.



telnet> q
Connection closed.
admin@devbox:tutorial$
```
The port forwarding rules for this sandbox are already set up to forward port 57777 on each router to a pre-determined port as shown in the connection details on the previous page. So make sure you **configure gRPC port on either router to be 57777 in order to access the gRPC server over the external NAT IP address=10.10.20.170**.  



Combining these configurations, the final configuration for `dial-in` telemetry setup on either router will be:

```
!
grpc
 no-tls
 port 57777
!
!
telemetry model-driven
 sensor-group IPV6Neighbor
  sensor-path Cisco-IOS-XR-ipv6-nd-oper:ipv6-node-discovery/nodes/node/neighbor-interfaces/neighbor-interface/host-addresses/host-address
 !
 subscription IPV6
  sensor-group-id IPV6Neighbor sample-interval 15000
 !
!
end
```

We will utilize router `r1` as the guinea pig for our Telemetry client/collector.
Applying the above configuration to router `r1`, we get:

```
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#show  configuration commit changes last 1
Mon Sep  3 10:50:15.306 UTC
Building configuration...
!! IOS XR Configuration version = 6.4.1
grpc
 no-tls
 port 57777
!
telemetry model-driven
 sensor-group IPV6Neighbor
  sensor-path Cisco-IOS-XR-ipv6-nd-oper:ipv6-node-discovery/nodes/node/neighbor-interfaces/neighbor-interface/host-addresses/host-address
 !
 subscription IPV6
  sensor-group-id IPV6Neighbor sample-interval 15000
 !
!
end
```

If we wait a few seconds, we will notice that this sensor-path gets `Resolved` indicating that the router is now ready to send Telemetry data to an external collector.


<p><pre><code>
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#show  telemetry model-driven subscription IPV6 internal
Mon Sep  3 10:50:20.451 UTC
Subscription:  IPV6
-------------
  State:       NA
  Sensor groups:
  Id: IPV6Neighbor
    Sample Interval:      15000 ms
    Sensor Path:          Cisco-IOS-XR-ipv6-nd-oper:ipv6-node-discovery/nodes/node/neighbor-interfaces/neighbor-interface/host-addresses/host-address
    <mark>Sensor Path State:    Resolved</mark>

  Collection Groups:
  ------------------
  No active collection groups

RP/0/RP0/CPU0:r1#

</code></pre></p>


## Testing the Sensor path

Before we proceed, let's actually test the sensor path to make sure we're getting the relevant data. Starting with release 6.3.1, this can be done on the router itself  by using the following CLI command:

<p><pre><code>
run mdt_exec -s &lt;your_sensor_path&gt; -c &lt;cadence&gt;
</code></pre></p>

Trying this out on router `r1` for the sensor_path=`Cisco-IOS-XR-ipv6-nd-oper:ipv6-node-discovery/nodes/node/neighbor-interfaces/neighbor-interface/host-addresses/host-address` and cadence=`2000` (2 seconds), we get:

<p style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #e6f2f7;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);">Just press `Enter` to terminate.
</p>  

```
RP/0/RP0/CPU0:r1#run mdt_exec -s Cisco-IOS-XR-ipv6-nd-oper:ipv6-node-discovery/nodes/node/neighbor-interfaces/neighbor-interface/host-addresses/host-address -c 2000
Mon Sep  3 17:54:56.475 UTC
Enter any key to exit...
 Sub_id 200000001, flag 0, len 0
 Sub_id 200000001, flag 4, len 3072
--------
{"node_id_str":"r1","subscription_id_str":"app_TEST_200000001","encoding_path":"Cisco-IOS-XR-ipv6-nd-oper:ipv6-node-discovery/nodes/node/neighbor-interfaces/neighbor-interface/host-addresses/host-address","collection_id":4,"collection_start_time":1535997296669,"msg_timestamp":1535997296675,"data_json":[{"timestamp":1535997296674,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/0","host-address":"1010:1010::20"},"content":{"last-reached-time":{"seconds":38},"reachability-state":"reachable","link-layer-address":"5254.0093.8ab0","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"dynamic","interface-name":"Gi0/0/0/0","location":"0/0/CPU0","is-router":true,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997296674,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/0","host-address":"fe80::5054:ff:fe93:8ab0"},"content":{"last-reached-time":{"seconds":179},"reachability-state":"reachable","link-layer-address":"5254.0093.8ab0","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"dynamic","interface-name":"Gi0/0/0/0","location":"0/0/CPU0","is-router":true,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997296675,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/0","host-address":"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"},"content":{"last-reached-time":{"seconds":0},"reachability-state":"reachable","link-layer-address":"0000.0000.0000","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"static","interface-name":"Gi0/0/0/0","location":"0/0/CPU0","is-router":false,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997296676,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/1","host-address":"2020:2020::20"},"content":{"last-reached-time":{"seconds":170},"reachability-state":"reachable","link-layer-address":"5254.0093.8ab1","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"dynamic","interface-name":"Gi0/0/0/1","location":"0/0/CPU0","is-router":true,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997296676,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/1","host-address":"fe80::5054:ff:fe93:8ab1"},"content":{"last-reached-time":{"seconds":165},"reachability-state":"reachable","link-layer-address":"5254.0093.8ab1","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"dynamic","interface-name":"Gi0/0/0/1","location":"0/0/CPU0","is-router":true,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997296676,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/1","host-address":"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"},"content":{"last-reached-time":{"seconds":0},"reachability-state":"reachable","link-layer-address":"0000.0000.0000","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"static","interface-name":"Gi0/0/0/1","location":"0/0/CPU0","is-router":false,"serg-flags":255,"vrfid":1610612736}}],"collection_end_time":1535997296677}
--------
 Sub_id 200000001, flag 4, len 3068
--------
{"node_id_str":"r1","subscription_id_str":"app_TEST_200000001","encoding_path":"Cisco-IOS-XR-ipv6-nd-oper:ipv6-node-discovery/nodes/node/neighbor-interfaces/neighbor-interface/host-addresses/host-address","collection_id":5,"collection_start_time":1535997298677,"msg_timestamp":1535997298684,"data_json":[{"timestamp":1535997298683,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/0","host-address":"1010:1010::20"},"content":{"last-reached-time":{"seconds":40},"reachability-state":"reachable","link-layer-address":"5254.0093.8ab0","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"dynamic","interface-name":"Gi0/0/0/0","location":"0/0/CPU0","is-router":true,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997298683,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/0","host-address":"fe80::5054:ff:fe93:8ab0"},"content":{"last-reached-time":{"seconds":181},"reachability-state":"delay","link-layer-address":"5254.0093.8ab0","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"dynamic","interface-name":"Gi0/0/0/0","location":"0/0/CPU0","is-router":true,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997298683,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/0","host-address":"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"},"content":{"last-reached-time":{"seconds":0},"reachability-state":"reachable","link-layer-address":"0000.0000.0000","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"static","interface-name":"Gi0/0/0/0","location":"0/0/CPU0","is-router":false,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997298685,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/1","host-address":"2020:2020::20"},"content":{"last-reached-time":{"seconds":172},"reachability-state":"reachable","link-layer-address":"5254.0093.8ab1","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"dynamic","interface-name":"Gi0/0/0/1","location":"0/0/CPU0","is-router":true,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997298685,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/1","host-address":"fe80::5054:ff:fe93:8ab1"},"content":{"last-reached-time":{"seconds":167},"reachability-state":"reachable","link-layer-address":"5254.0093.8ab1","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"dynamic","interface-name":"Gi0/0/0/1","location":"0/0/CPU0","is-router":true,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997298685,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/1","host-address":"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"},"content":{"last-reached-time":{"seconds":0},"reachability-state":"reachable","link-layer-address":"0000.0000.0000","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"static","interface-name":"Gi0/0/0/1","location":"0/0/CPU0","is-router":false,"serg-flags":255,"vrfid":1610612736}}],"collection_end_time":1535997298686}
--------

RP/0/RP0/CPU0:r1#

```


Let's just structure the data above a little better to see what we're
receiving. Drop into router `r1`'s  python shell and use the json module to "pretty" print it.

```
RP/0/RP0/CPU0:r1#bash
Mon Sep  3 17:58:00.770 UTC
[r1:~]$
[r1:~]$ python
Python 2.7.3 (default, Dec 12 2017, 08:22:03)
[GCC 4.9.1] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import json
>>>
>>> data="""{"node_id_str":"r1","subscription_id_str":"app_TEST_200000001","encoding_path":"Cisco-IOS-XR-ipv6-nd-oper:ipv6-node-discovery/nodes/node/neighbor-interfaces/neighbor-interface/host-addresses/host-address","collection_id":6,"collection_start_time":1535997300686,"msg_timestamp":1535997300703,"data_json":[{"timestamp":1535997300701,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/0","host-address":"1010:1010::20"},"content":{"last-reached-time":{"seconds":42},"reachability-state":"reachable","link-layer-address":"5254.0093.8ab0","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"dynamic","interface-name":"Gi0/0/0/0","location":"0/0/CPU0","is-router":true,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997300701,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/0","host-address":"fe80::5054:ff:fe93:8ab0"},"content":{"last-reached-time":{"seconds":183},"reachability-state":"delay","link-layer-address":"5254.0093.8ab0","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"dynamic","interface-name":"Gi0/0/0/0","location":"0/0/CPU0","is-router":true,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997300701,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/0","host-address":"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"},"content":{"last-reached-time":{"seconds":0},"reachability-state":"reachable","link-layer-address":"0000.0000.0000","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"static","interface-name":"Gi0/0/0/0","location":"0/0/CPU0","is-router":false,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997300707,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/1","host-address":"2020:2020::20"},"content":{"last-reached-time":{"seconds":174},"reachability-state":"reachable","link-layer-address":"5254.0093.8ab1","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"dynamic","interface-name":"Gi0/0/0/1","location":"0/0/CPU0","is-router":true,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997300707,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/1","host-address":"fe80::5054:ff:fe93:8ab1"},"content":{"last-reached-time":{"seconds":169},"reachability-state":"reachable","link-layer-address":"5254.0093.8ab1","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"dynamic","interface-name":"Gi0/0/0/1","location":"0/0/CPU0","is-router":true,"serg-flags":255,"vrfid":1610612736}},{"timestamp":1535997300707,"keys":{"node-name":"0/0/CPU0","interface-name":"GigabitEthernet0/0/0/1","host-address":"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"},"content":{"last-reached-time":{"seconds":0},"reachability-state":"reachable","link-layer-address":"0000.0000.0000","encapsulation":"arpa","selected-encapsulation":"arpa","origin-encapsulation":"static","interface-name":"Gi0/0/0/1","location":"0/0/CPU0","is-router":false,"serg-flags":255,"vrfid":1610612736}}],"collection_end_time":1535997300709}"""
>>>
>>>
>>> print json.dumps(json.loads(data), indent=4)
{
   "encoding_path": "Cisco-IOS-XR-ipv6-nd-oper:ipv6-node-discovery/nodes/node/neighbor-interfaces/neighbor-interface/host-addresses/host-address",
   "subscription_id_str": "app_TEST_200000001",
   "collection_start_time": 1535997300686,
   "msg_timestamp": 1535997300703,
   "collection_end_time": 1535997300709,
   "node_id_str": "r1",
   "data_json": [
       {
           "keys": {
               "node-name": "0/0/CPU0",
               "interface-name": "GigabitEthernet0/0/0/0",
               "host-address": "1010:1010::20"
           },
           "timestamp": 1535997300701,
           "content": {
               "vrfid": 1610612736,
               "interface-name": "Gi0/0/0/0",
               "last-reached-time": {
                   "seconds": 42
               },
               "link-layer-address": "5254.0093.8ab0",
               "selected-encapsulation": "arpa",
               "is-router": true,
               "serg-flags": 255,
               "reachability-state": "reachable",
               "location": "0/0/CPU0",
               "encapsulation": "arpa",
               "origin-encapsulation": "dynamic"
           }
       },
       {
           "keys": {
               "node-name": "0/0/CPU0",
               "interface-name": "GigabitEthernet0/0/0/0",
               "host-address": "fe80::5054:ff:fe93:8ab0"
           },
           "timestamp": 1535997300701,
           "content": {
               "vrfid": 1610612736,
               "interface-name": "Gi0/0/0/0",
               "last-reached-time": {
                   "seconds": 183
               },
               "link-layer-address": "5254.0093.8ab0",
               "selected-encapsulation": "arpa",
               "is-router": true,
               "serg-flags": 255,
               "reachability-state": "delay",
               "location": "0/0/CPU0",
               "encapsulation": "arpa",
               "origin-encapsulation": "dynamic"
           }
       },
       {
           "keys": {
               "node-name": "0/0/CPU0",
               "interface-name": "GigabitEthernet0/0/0/0",
               "host-address": "ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"
           },
           "timestamp": 1535997300701,
           "content": {
               "vrfid": 1610612736,
               "interface-name": "Gi0/0/0/0",
               "last-reached-time": {
                   "seconds": 0
               },
               "link-layer-address": "0000.0000.0000",
               "selected-encapsulation": "arpa",
               "is-router": false,
               "serg-flags": 255,
               "reachability-state": "reachable",
               "location": "0/0/CPU0",
               "encapsulation": "arpa",
               "origin-encapsulation": "static"
           }
       },
       {
           "keys": {
               "node-name": "0/0/CPU0",
               "interface-name": "GigabitEthernet0/0/0/1",
               "host-address": "2020:2020::20"
           },
           "timestamp": 1535997300707,
           "content": {
               "vrfid": 1610612736,
               "interface-name": "Gi0/0/0/1",
               "last-reached-time": {
                   "seconds": 174
               },
               "link-layer-address": "5254.0093.8ab1",
               "selected-encapsulation": "arpa",
               "is-router": true,
               "serg-flags": 255,
               "reachability-state": "reachable",
               "location": "0/0/CPU0",
               "encapsulation": "arpa",
               "origin-encapsulation": "dynamic"
           }
       },
       {
           "keys": {
               "node-name": "0/0/CPU0",
               "interface-name": "GigabitEthernet0/0/0/1",
               "host-address": "fe80::5054:ff:fe93:8ab1"
           },
           "timestamp": 1535997300707,
           "content": {
               "vrfid": 1610612736,
               "interface-name": "Gi0/0/0/1",
               "last-reached-time": {
                   "seconds": 169
               },
               "link-layer-address": "5254.0093.8ab1",
               "selected-encapsulation": "arpa",
               "is-router": true,
               "serg-flags": 255,
               "reachability-state": "reachable",
               "location": "0/0/CPU0",
               "encapsulation": "arpa",
               "origin-encapsulation": "dynamic"
           }
       },
       {
           "keys": {
               "node-name": "0/0/CPU0",
               "interface-name": "GigabitEthernet0/0/0/1",
               "host-address": "ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"
           },
           "timestamp": 1535997300707,
           "content": {
               "vrfid": 1610612736,
               "interface-name": "Gi0/0/0/1",
               "last-reached-time": {
                   "seconds": 0
               },
               "link-layer-address": "0000.0000.0000",
               "selected-encapsulation": "arpa",
               "is-router": false,
               "serg-flags": 255,
               "reachability-state": "reachable",
               "location": "0/0/CPU0",
               "encapsulation": "arpa",
               "origin-encapsulation": "static"
           }
       }
   ],
   "collection_id": 6
}
>>>
>>>
>>> exit()
[r1:~]$
[r1:~]$ exit
logout

RP/0/RP0/CPU0:r1#
RP/0/RP0/CPU0:r1#

```


<p style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #eff9ef;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);">Perfect! We're receiving all the fields we need as per the original show command. You're now ready to start building your own Telemetry collector.
</p>  
