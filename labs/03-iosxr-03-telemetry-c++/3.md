# Client Code: Install gRPC and regenerate bindings

We will develop the telemetry client on the `devbox`. The Telemetry client will connect to the router over gRPC. So, the steps we intend to perform as part of this section are:

*  **Install the protoc compiler**: Since we intend to build a c++ telemetry collector , we must install `protoc` by building protobuf:3.5.0 package from github.  

*  Provide the appropriate model (.proto) file mapped to the router's yang model to the compiler and **generate bindings** (i.e. actual code in the form of .cpp and .h files from the .proto files). This generated code is then used as a set of libraries to create our own client code.  

The process is depicted below:  

![protoc_compilation](assets/images/protoc_compilation.png)


## Connect to the Devbox

Connection details are explained in the beginning of this lab. SSH into devbox:  

<p style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #e6f2f7;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);">**Username**: admin<br/>**Password**: admin<br/>**SSH port**: 2211
</p>  


```
Laptop-Terminal:$ ssh -p 2211 admin@10.10.20.170
admin@10.10.20.170's password:
Last login: Sun Aug 26 19:18:39 2018 from 192.168.122.1
admin@devbox:~$
admin@devbox:~$

```  


## IOS-XR Telemetry gRPC proto files

Streaming Telemetry in IOS-XR is a mechanism to help push operational information from the route router by using  Yang-models to set up sensor-paths and Subscriptions that clients can subscribe to and receive information from.

However, these Oper Yang-models can also be mapped to equivalent protobuf models, represented in `.proto` files.
This is especially useful when we need to write a Telemetry client code from scratch.
By exposing these protobuf-based capabilities over a gRPC connection, it enables a user to utilize gRPC's intrinsic architecture to generate bindings(code/libraries) in a language of choice (python, c++, golang etc.).

To view the .proto files corresponding to the Oper Yang models in XR, clone the following git repo on the devbox and peek into the `proto_archive/` directory:

><https://github.com/akshshar/bigmuddy-network-telemetry-proto>  

```
admin@devbox:~$
admin@devbox:~$
admin@devbox:~$ git clone https://github.com/cisco/bigmuddy-network-telemetry-proto
Cloning into 'bigmuddy-network-telemetry-proto'...
remote: Counting objects: 11287, done.
remote: Total 11287 (delta 0), reused 0 (delta 0), pack-reused 11287
Receiving objects: 100% (11287/11287), 2.96 MiB | 1.94 MiB/s, done.
Resolving deltas: 100% (3595/3595), done.
Checking connectivity... done.
admin@devbox:~$
admin@devbox:~$
admin@devbox:~$
admin@devbox:~$ cd bigmuddy-network-telemetry-proto/proto_archive/
admin@devbox:proto_archive$ ls -l
total 1744
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_aaa_locald_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_aaa_protocol_radius_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_alarmgr_server_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_bundlemgr_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_cdp_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_clns_isis_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_controller_optics_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_controller_otu_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_crypto_sam_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_dpt_telemetry_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_drivers_media_eth_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_es_acl_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ethernet_lldp_oper
drwxrwxr-x 5 admin admin    4096 Sep  3 05:01 cisco_ios_xr_fib_common_oper
drwxrwxr-x 4 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ifmgr_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_infra_alarm_logger_oper
drwxrwxr-x 4 admin admin    4096 Sep  3 05:01 cisco_ios_xr_infra_correlator_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_infra_objmgr_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_infra_policymgr_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_infra_rcmd_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_infra_rmf_oper
drwxrwxr-x 5 admin admin    4096 Sep  3 05:01 cisco_ios_xr_infra_rsi_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_infra_statsd_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_infra_syslog_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_infra_tc_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_invmgr_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ip_bfd_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ip_domain_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ip_iep_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ip_ntp_oper
drwxrwxr-x 4 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ip_rib_ipv4_oper
drwxrwxr-x 4 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ip_rib_ipv6_oper
drwxrwxr-x 4 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ip_rsvp_oper
drwxrwxr-x 5 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ip_tcp_oper
drwxrwxr-x 4 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ip_udp_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv4_acl_oper
drwxrwxr-x 4 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv4_arp_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv4_bgp_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv4_hsrp_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv4_io_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv4_ospf_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv4_vrrp_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv6_acl_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv6_io_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv6_ma_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv6_nd_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv6_new_dhcpv6d_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_ipv6_ospfv3_oper
drwxrwxr-x 5 admin admin    4096 Sep  3 05:01 cisco_ios_xr_l2_eth_infra_oper
drwxrwxr-x 6 admin admin    4096 Sep  3 05:01 cisco_ios_xr_l2vpn_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_lib_keychain_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_lib_mpp_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_linux_os_reboot_history_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_manageability_object_tracking_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_manageability_perfmgmt_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_man_ems_oper
drwxrwxr-x 4 admin admin    4096 Sep  3 05:01 cisco_ios_xr_man_xml_ttyagent_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_mpls_ldp_oper
drwxrwxr-x 4 admin admin    4096 Sep  3 05:01 cisco_ios_xr_mpls_lsd_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_mpls_static_oper
drwxrwxr-x 9 admin admin    4096 Sep  3 05:01 cisco_ios_xr_mpls_te_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_mpls_vpn_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_nto_misc_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_pbr_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_pbr_vservice_ea_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_pbr_vservice_mgr_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_pfi_im_cmd_oper
drwxrwxr-x 4 admin admin    4096 Sep  3 05:01 cisco_ios_xr_plat_chas_invmgr_oper
drwxrwxr-x 4 admin admin    4096 Sep  3 05:01 cisco_ios_xr_pmengine_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_policy_repository_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_qos_ma_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_rgmgr_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_sdr_invmgr_diag_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_segment_routing_ms_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_shellutil_filesystem_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_shellutil_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_snmp_agent_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_spirit_install_instmgr_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_telemetry_model_driven_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_tty_management_cmd_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_tty_server_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_wanphy_ui_oper
drwxrwxr-x 3 admin admin    4096 Sep  3 05:01 cisco_ios_xr_wdsysmon_fd_oper
-rw-rw-r-- 1 admin admin 1342807 Sep  3 05:01 cisco_ios_xr_yang2proto_map.json
drwxrwxr-x 2 admin admin    4096 Sep  3 05:01 mdt_grpc_dialin
drwxrwxr-x 2 admin admin    4096 Sep  3 05:01 mdt_grpc_dialout
-rw-rw-r-- 1 admin admin   80949 Sep  3 05:01 noschema
drwxrwxr-x 4 admin admin    4096 Sep  3 05:01 old
-rw-rw-r-- 1 admin admin    8187 Sep  3 05:01 telemetry.proto
```  

This represents all the available Oper Yang models arranged as folders containing the .proto files.

Since we intend to stream telemetry data related to the following sensor path:

>Cisco-IOS-XR-ipv6-nd-oper:ipv6-node-discovery/nodes/node/neighbor-interfaces/neighbor-interface/host-addresses/host-address


Let's consider the .proto files that will be of interest in this lab. The .proto files required to create our own client are of 3 types

1. **Associated with the Oper Yang model(s)**: Here we intend to use the `Cisco-IOS-XR-ipv6-nd-oper.yang` model. So, dropping into `proto_archive/cisco_ios_xr_ipv6_nd_oper/` folder, we find:

  ```
  admin@devbox:proto_archive$ cd cisco_ios_xr_ipv6_nd_oper
  admin@devbox:cisco_ios_xr_ipv6_nd_oper$ tree .
  .
  └── ipv6_node_discovery
      └── nodes
          └── node
              ├── bundle_interfaces
              │   └── bundle_interface
              │       └── ipv6_nd_if_entry.proto
              ├── bundle_nodes
              │   └── bundle_node
              │       └── ipv6_nd_bl_node_entry.proto
              ├── interfaces
              │   └── interface
              │       └── ipv6_nd_if_params.proto
              ├── nd_virtual_routers
              │   └── nd_virtual_router
              │       └── ipv6_nd_vr_entry.proto
              ├── neighbor_interfaces
              │   └── neighbor_interface
              │       └── host_addresses
              │           └── host_address
              │               └── ipv6_nd_neighbor_entry.proto
              └── neighbor_summary
                  └── ipv6_nd_neighbor_entry_summary.proto

  16 directories, 6 files
  admin@devbox:cisco_ios_xr_ipv6_nd_oper$

  ```

  It is fairly clear from our sensor path, that the proto file we are interested in is `ipv6_nd_neighbor_entry.proto`. Opening up this proto file, we get:

  ```
  admin@devbox:cisco_ios_xr_ipv6_nd_oper$ cat ipv6_node_discovery/nodes/node/neighbor_interfaces/neighbor_interface/host_addresses/host_address/ipv6_nd_neighbor_entry.proto
  // Copyright (c) 2015, Cisco Systems
  // All rights reserved.
  //
  // Redistribution and use in source and binary forms, with or without
  // modification, are permitted provided that the following conditions
  // are met:
  //
  // 1. Redistributions of source code must retain the above copyright notice,
  //    this list of conditions and the following disclaimer.
  //
  // 2. Redistributions in binary form must reproduce the above copyright
  //    notice, this list of conditions and the following disclaimer in the
  //    documentation and/or other materials provided with the distribution.
  //
  // 3. Neither the name of the copyright holder nor the names of its
  //    contributors may be used to endorse or promote products derived
  //    from this software without specific prior written permission.
  //
  // THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
  // "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
  // TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  // PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR
  // CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  // EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  // PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  // PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  // LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  // NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  // SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

  // This file is autogenerated
  //
  // The following edits are possible, without affecting the validity of the
  // file:
  //
  //  * Fields may be renamed.
  //  * Fields may be deleted.
  //  * The unique numbered tag for a field may be changed, provided that
  //    the ordering of tags for fields within a message is preserved.
  //  * Message types may be renamed.
  //  * Message types may be deleted (if all fields that reference them
  //    have been deleted).
  //
  // All Cisco message and field extensions must be preserved (except when the
  // field itself is being deleted).

  syntax = "proto3";

  package cisco_ios_xr_ipv6_nd_oper.ipv6_node_discovery.nodes.node.neighbor_interfaces.neighbor_interface.host_addresses.host_address;

  // IPv6 ND neighbor entry
  message ipv6_nd_neighbor_entry_KEYS {
      string node_name = 1;
      string interface_name = 2;
      string host_address = 3;
  }

  message ipv6_nd_neighbor_entry {
      // Last time of reachability
      bag_timespec last_reached_time = 50;
      // Current state
      string reachability_state = 51;
      // Link-Layer Address
      string link_layer_address = 52;
      // Preferred media encap type
      string encapsulation = 53;
      // Selected media encap
      string selected_encapsulation = 54;
      // Neighbor origin
      string origin_encapsulation = 55;
      // Interface name
      string interface_name = 56;
      // Location where the neighbor entry exists
      string location = 57;
      // IsRouter
      bool is_router = 58;
  }

  // Timespec specifying the number of seconds since the base time of 00:00:00 GMT, 1 January 1970.
  message bag_timespec {
      // Number of seconds
      uint32 seconds = 1;
  }

  admin@devbox:cisco_ios_xr_ipv6_nd_oper$

  ```

  We are looking for the data we obtain from the `show ipv6 neighbors` command. It can be seen from the above output that this proto file defines the data structures such as `interface_name`, `host_address`, `reachability_state`, `link_layer_address` - exactly what we intend to stream.

2. **Associated with the Mode of Connection**: There are two modes of connection(as described in the 1st lab associated with this module): `Dial-in` and `Dial-out`. `Dial-in` implies that the client initiates a connection to the router over gRPC and then sets up a subscription to receive data post authentication. `Dial-out` implies that the router configuration is set up to identify a specific destination (ip-address + port) to send data to and the client simply opens up a simple TCP/UDP (or gRPC) port to receive the data from the router.
  There are proto files available for both these techniques, as shown below:

  <p><pre><code>
  admin@devbox:proto_archive$ pwd
  /home/admin/bigmuddy-network-telemetry-proto/proto_archive
  admin@devbox:proto_archive$
  admin@devbox:proto_archive$ ls *mdt_grpc*
  mdt_grpc_dialin:
  <mark>mdt_grpc_dialin.proto</mark>

  mdt_grpc_dialout:
  <mark>mdt_grpc_dialout.proto</mark>
  admin@devbox:proto_archive$
  </code></pre></p>

  In this lab, we intend to use gRPC dial-in as the mode of connection, so we select the `mdt_grpc_dialin.proto` file.

  Let's take a look at the RPCs defined inside `mdt_grpc_dialin.proto` file:

  <p><pre><code>
  admin@devbox:proto_archive$ cat mdt_grpc_dialin/mdt_grpc_dialin.proto
  syntax = "proto3";

  // Package implements gRPC Model Driven Telemetry service
  package IOSXRExtensibleManagabilityService;

  service gRPCConfigOper {

      // Configuration related commands

      rpc GetConfig(ConfigGetArgs) returns(stream ConfigGetReply) {};

      rpc MergeConfig(ConfigArgs) returns(ConfigReply) {};

      rpc DeleteConfig(ConfigArgs) returns(ConfigReply) {};

      rpc ReplaceConfig(ConfigArgs) returns(ConfigReply) {};

      rpc CliConfig(CliConfigArgs) returns(CliConfigReply) {};

      rpc CommitReplace(CommitReplaceArgs) returns (CommitReplaceReply) {};

      // Do we need implicit or explicit commit
      //
      rpc CommitConfig(CommitArgs) returns(CommitReply) {};

      rpc ConfigDiscardChanges(DiscardChangesArgs) returns(DiscardChangesReply) {};

      // Get only returns oper data
      //
      rpc GetOper(GetOperArgs) returns(stream GetOperReply) {};
      // Do we need "Get" also to give combined oper and config?

      // Get Telemetry Data
      <mark>rpc CreateSubs(CreateSubsArgs) returns(stream CreateSubsReply) {};</mark>
  }

  ...................... Output Snipped.......

  </code></pre></p>

  As highlighted above, we are primarily interested in the `CreateSubs` RPC that allows a client to specify the `CreateSubsArgs` and specify the name of the subscription and the encoding technique used (GPB, GPBKV):

  ```
  message CreateSubsArgs {
       int64 ReqId = 1;
       int64 encode = 2;
       string subidstr = 3;
  }
  ```
3. **Associated with the Encoding/Decoding Process**: The data pushed as part of the telemetry stream can be `GPB` or `GPBKV` based. In this lab, we use `GPB`. Further, since we are using mdt_grpc_dialin, we can specify the exact encoding as part of the client subscription process. The relevant `.proto` file is `telemetry.proto`, dumped below:

  ```
  admin@devbox:proto_archive$
  admin@devbox:proto_archive$ pwd
  /home/admin/bigmuddy-network-telemetry-proto/proto_archive
  admin@devbox:proto_archive$
  admin@devbox:proto_archive$ cat telemetry.proto

  /* ----------------------------------------------------------------------------
   * telemetry_bis.proto - Telemetry protobuf definitions
   *
   * August 2016
   *
   * Copyright (c) 2016 by Cisco Systems, Inc.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   * ----------------------------------------------------------------------------
   */

  syntax = "proto3";
  package telemetry;

  // Telemetry message is the outermost payload message used to stream
  // telemetry in a Model Driven Telemetry (MDT) system. MDT provides a
  // mechanism for an external entity to subscribe to a data set defined in
  // a Yang model and receive periodic or event-based updates of the data
  // set from an MDT-capable device.
  message Telemetry {
    //
    // node_id_str is a string encoded unique node ID of the MDT-capable
    // device producing the message. (node_id_uuid alternative is not currently
    // produced in IOS-XR)
    oneof node_id {
      string node_id_str = 1;
      // bytes node_id_uuid = 2;
    }
    //
    // subscription_id_str is the name of the subscription against which
    // this content is being produced. (subscription_id alternative is not
    //  currently produced in IOS-XR)
    oneof subscription {
      string   subscription_id_str = 3;
      // uint32   subscription_id = 4;
    }
    //
    // sensor_path is not currently produced in IOS-XR
    // string   sensor_path = 5;
    //
    // encoding_path is the Yang path leading to the content in this message.
    // The Yang tree encoded in the content section of this message is rooted
    // at the point described by the encoding_path.
    string   encoding_path = 6;
    //
    // model_version is not currently produced in IOS-XR
    // string   model_version = 7;
    //
    // collection_id identifies messages belonging to a collection round.
    // Multiple message may be generated from a collection round.
    uint64   collection_id = 8;
    //
    // collection_start_time is the time when the collection identified by
    // the collection_id begins - encoded as milliseconds since the epoch.
    // If a single collection is spread over multiple Telemetry Messages,
    // collection_start_time may be encoded in the first Telemetry Message
    // for the collection only.
    uint64   collection_start_time = 9;
    //
    // msg_timestamp is the time when the data encoded in the Telemetry
    // message is generated - encoded as milliseconds since the epoch.
    uint64   msg_timestamp = 10;
    //
    // data_gpbkv contains the payload data if data is being encoded in the
    // self-describing GPB-KV format.
    repeated TelemetryField data_gpbkv = 11;
    //
    // data_gpb contains the payload data if data is being encoded as
    // serialised GPB messages.
    TelemetryGPBTable data_gpb = 12;
    //
    // collection_end_time is the timestamp when the last Telemetry message
    // for a collection has been encoded - encoded as milliseconds since the
    // epoch. If a single collection is spread over multiple Telemetry
    // messages, collection_end_time is encoded in the last Telemetry Message
    // for the collection only.
    uint64 collection_end_time = 13;
    //
    // heartbeat_sequence_number is not currently produced in IOS-XR
    // uint64   heartbeat_sequence_number = 14; // not produced
  }

  //
  // TelemetryField messages are used to export content in the self
  // describing GPB KV form. The TelemetryField message is sufficient to
  // decode telemetry messages for all models. KV-GPB encoding is very
  // similar in concept, to JSON encoding
  message TelemetryField {
    //
    // timestamp represents the starting time of the generation of data
    // starting from this key, value pair in this message - encoded as
    // milliseconds since the epoch. It is encoded when different from the
    // msg_timestamp in the containing Telemetry Message. This field can be
    // omitted if the value is the same as a TelemetryField message up the
    // hierarchy within the same Telemetry Message as well.
    uint64         timestamp = 1;
    //
    // name: string encoding of the name in the key, value pair. It is
    // the corresponding YANG element name.
    string         name = 2;
    //
    // value_by_type, if present, for the corresponding YANG element
    // represented by the name field in the same TelemetryField message. The
    // value is encoded to the matching type as defined in the YANG model.
    // YANG models often define new types (derived types) using one or more
    // base types.  The types included in the oneof grouping is sufficient to
    // represent such derived types. Derived types represented as a Yang
    // container are encoded using the nesting primitive defined in this
    // encoding proposal.
    oneof value_by_type {
      bytes          bytes_value = 4;
      string         string_value = 5;
      bool           bool_value = 6;
      uint32         uint32_value = 7;
      uint64         uint64_value = 8;
      sint32         sint32_value = 9;
      sint64         sint64_value = 10;
      double         double_value = 11;
      float          float_value = 12;
    }
    //
    // The Yang model may include nesting (e.g hierarchy of containers). The
    // next level of nesting, if present, is encoded, starting from fields.
    repeated TelemetryField fields = 15;
  }

  // TelemetryGPBTable contains a repeated number of TelemetryRowGPB,
  // each of which represents content from a subtree instance in the
  // the YANG model. For example; a TelemetryGPBTable might contain
  // the interface statistics of a collection of interfaces.
  message TelemetryGPBTable {
    repeated TelemetryRowGPB row = 1;
  }

  //
  // TelemetryRowGPB, in conjunction with the Telemetry encoding_path and
  // model_version, unambiguously represents the root of a subtree in
  // the YANG model, and content from that subtree encoded in serialised
  // GPB messages. For example; a TelemetryRowGPB might contain the
  // interface statistics of one interface. Per encoding-path .proto
  // messages are required to decode keys/content pairs below.
  message TelemetryRowGPB {
    //
    // timestamp at which the data for this instance of the TelemetryRowGPB
    // message was generated by an MDT-capable device - encoded as
    // milliseconds since the epoch.  When included, this is typically
    // different from the msg_timestamp in the containing Telemetry message.
    uint64 timestamp = 1;
    //
    // keys: if the encoding-path includes one or more list elements, and/or
    // ends in a list element, the keys field is a GPB encoded message that
    // contains the sequence of key values for each such list element in the
    // encoding-path traversed starting from the root.  The set of keys
    // unambiguously identifies the instance of data encoded in the
    // TelemetryRowGPB message. Corresponding protobuf message definition will
    // be required to decode the byte stream. The encoding_path field in
    // Telemetry message, together with model_version field should be
    // sufficient to identify the corresponding protobuf message.
    bytes keys = 10;
    //
    // content: the content field is a GPB encoded message that contains the
    // data for the corresponding encoding-path. A separate decoding pass
    // would be performed by consumer with the content field as a GPB message
    // and the matching .proto used to decode the message. Corresponding
    // protobuf message definition will be required to decode the byte
    // stream. The encoding_path field in Telemetry message, together with
    // model_version field should be sufficient to identify the corresponding
    // protobuf message. The decoded combination of keys (when present) and
    // content, unambiguously represents an instance of the data set, as
    // defined in the Yang model, identified by the encoding-path in the
    // containing Telemetry message.
  bytes content = 11;
  }
  ```



## Build c++ bindings from Proto files

To generate the c++ bindings, we need the `protoc` compiler available on the `devbox`.
For c++, the protobuf compiler (protoc) needs to be built from scratch. We choose a fairly recent version==`3.5.0` to be compatible with the gRPC version=`1.7.0` that we will build and install subsequently.

<p style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #e6f2f7;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);">The gRPC version that must be used for the client code is closely tied to the gRPC version used by the server code present in a given IOS-XR release.  

**In the IOS-XR Programmability sandbox, the routers are running IOS-XR release 6.4.1 which utilizes the gRPC version=`1.7.0`.  
Hence `grpcio` version selected for this lab will have version=`1.7.0`**
</p>    


### Clone Sample Telemetry Collectors Git Repo

The initial build and install process for protobuf and grpc for c++ is automated using scripts within the <https://github.com/ios-xr/telemetry-grpc-collectors> git repository.
So let's clone this repo before we start the installation of the required tools and libraries.

<p style="margin: 2em 0 !important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #fdefef;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);">This git repository contains the git repo `https://github.com/cisco/bigmuddy-network-telemetry-proto` as a submodule. So make sure you use the `--recursive` flag to clone this repo so that it fetches the last used version of `https://github.com/cisco/bigmuddy-network-telemetry-proto` into the `bigmuddy-network-telemetry-proto` sub-folder. </p>

```
admin@devbox:~$
admin@devbox:~$ pwd
/home/admin
admin@devbox:~$
admin@devbox:~$ git clone --recursive https://github.com/ios-xr/telemetry-grpc-collectors
Cloning into 'telemetry-grpc-collectors'...
remote: Counting objects: 92, done.
remote: Compressing objects: 100% (59/59), done.
remote: Total 92 (delta 38), reused 79 (delta 28), pack-reused 0
Unpacking objects: 100% (92/92), done.
Checking connectivity... done.
Submodule 'bigmuddy-network-telemetry-proto' (https://github.com/cisco/bigmuddy-network-telemetry-proto) registered for path 'bigmuddy-network-telemetry-proto'
Cloning into 'bigmuddy-network-telemetry-proto'...
remote: Counting objects: 24542, done.
remote: Total 24542 (delta 0), reused 0 (delta 0), pack-reused 24542
Receiving objects: 100% (24542/24542), 6.06 MiB | 3.00 MiB/s, done.
Resolving deltas: 100% (8324/8324), done.
Checking connectivity... done.
Submodule path 'bigmuddy-network-telemetry-proto': checked out '4419cd20fb73f05d059a37fa3e41fe55f02a528f'
admin@devbox:~$
admin@devbox:~$
admin@devbox:~$ cd telemetry-grpc-collectors/
admin@devbox:telemetry-grpc-collectors$ admin@devbox:telemetry-grpc-collectors$ tree -L 1
.
├── bigmuddy-network-telemetry-proto
├── build
├── clients
└── README.md

3 directories, 1 file
admin@devbox:telemetry-grpc-collectors$

```


### Install the Build tools and Generate bindings

Hop into the `build/cpp` directory under the cloned git repo. You will find the following scripts:

```
admin@devbox:telemetry-grpc-collectors$ cd build/cpp
admin@devbox:cpp$ pwd
/home/admin/telemetry-grpc-collectors/build/cpp
admin@devbox:cpp$
admin@devbox:cpp$ ls -l
total 32
-rwxrwxr-x 1 admin admin 3332 Sep  3 11:26 build_ipv6_nd_lib.sh
-rwxrwxr-x 1 admin admin 3016 Sep  3 11:26 build_lib.sh
-rwxrwxr-x 1 admin admin  216 Sep  3 11:26 clean_ipv6_nd_lib.sh
-rwxrwxr-x 1 admin admin  152 Sep  3 11:26 clean.sh
-rwxrwxr-x 1 admin admin  812 Sep  3 11:26 gen-cpp-bindings-ipv6-nd.sh
-rwxrwxr-x 1 admin admin  724 Sep  3 11:26 gen-cpp-bindings.sh
drwxrwxr-x 2 admin admin 4096 Sep  3 11:26 ipv6-nd-make
-rw-rw-r-- 1 admin admin 1205 Sep  3 11:26 Makefile
admin@devbox:cpp$

```  

Notice the script `build_lib.sh`. This script builds and install protobuf and grpc on the system and also invokes the script: `gen-cpp-bindings.sh` that will create the c++ bindings from **all** the proto files (corresponding to all the oper yang models, and connection modes) under `bigmuddy-network-telemetry-proto/proto_archive`.  

In this lab, since we're focused on streaming information related to the `show ipv6 neighbors` command, we don't need to spend additional time building all the models. Instead let's build just the bindings associated with the YANG model: `Cisco-IOS-XR-ipv6-nd-oper.yang` and the different connection modes.    

For this we use the script `build_ipv6_nd_lib.sh` that helps install the tools and invokes the script `gen-cpp-bindings-ipv6-nd.sh` that builds only the bindings we need.


The contents of the script `build_ipv6_nd_lib.sh` are dumped below. It can be seen that this script accepts the grpc version and protobuf version to install on the system before extracting the required proto files and generating c++ bindings from them.


<p><pre><code>
admin@devbox:cpp$ cat build_ipv6_nd_lib.sh
#!/bin/bash

if [[ $(/usr/bin/id -u) -ne 0 ]]; then
    echo "Not running as sudo"
    echo "Please run the script as : sudo <scriptpath>"
    exit
fi

# The proto files to process
declare -a build_paths=("cisco_ios_xr_ipv6_nd_oper" "mdt_grpc_dialout" "mdt_grpc_dialin")

usage="
$(basename "$0") [-h] [-g/--grpc-version -p/--protobuf-version -v/--verbose] -- script to install desired versions of grpc, protobuf and build the libxrtelemetry.a library
where:
    -h  show this help text
    -g/--grpc-version specify the grpc version to be installed (mandatory argument)
    -p/--protobuf-version specify the protobuf version to be installed (mandatory argument)
    -v  get more verbose information during script execution
"

while true; do
  case "$1" in
    -v | --verbose )     VERBOSE=true; shift ;;
    -h | --help )        echo "$usage"; exit 0 ;;
    -g | --grpc-version )   GRPC_VERSION=$2; shift; shift;;
    -p | --protobuf-version ) PROTOBUF_VERSION=$2; shift; shift;;
    -- ) shift; break ;;
    * ) break ;;
  esac
done

if ! [[ $GRPC_VERSION ]] || ! [[ $PROTOBUF_VERSION ]]; then
   echo "Must specify both  -g/--grpc--version and -p/--protobuf-version, see usage below"
   echo "$usage"
   exit 0
fi

if [[ $VERBOSE ]];then
    set -x
fi

# Install pkg-config first
apt-get update && apt-get install -y \
         autoconf automake libtool curl make g++ unzip git pkg-config

PROTOBUF_INSTALLED_VERSION=`pkg-config --exists protobuf && pkg-config --modversion protobuf`
GRPC_INSTALLED_VERSION=`pkg-config --exists grpc && pkg-config --modversion grpc++`


SCRIPT_DIR="$(cd "$(dirname "${0}")"; echo "$(pwd)")"



if [[ $GRPC_INSTALLED_VERSION != $GRPC_VERSION ]] ||
        [[ $PROTOBUF_INSTALLED_VERSION != $PROTOBUF_VERSION ]]; then

    rm -rf ~/tempdir
    mkdir -p ~/tempdir/protobuf

    if [[ $PROTOBUF_INSTALLED_VERSION != $PROTOBUF_VERSION ]]; then
        #install protobuf
        cd ~/tempdir/protobuf
        mkdir protobuf-${PROTOBUF_VERSION}/
        curl -OL https://github.com/protocolbuffers/protobuf/releases/download/v${PROTOBUF_VERSION}/protobuf-all-${PROTOBUF_VERSION}.tar.gz && \
        tar -zxvf protobuf-all-${PROTOBUF_VERSION}.tar.gz --strip 1 -C ./protobuf-${PROTOBUF_VERSION}/ && \
        cd ~/tempdir/protobuf/protobuf-${PROTOBUF_VERSION}/ && \
        ./configure && \
        make && \
        make install &&\
        ldconfig

    fi

    if [[ $GRPC_INSTALLED_VERSION != $GRPC_VERSION ]]; then
        #install grpc
        git clone https://github.com/grpc/grpc.git -b v${GRPC_VERSION} ~/tempdir/grpc && \
        cd ~/tempdir/grpc && \
        git submodule update --init && \
        make && \
        make install
    fi
fi

cd ~/ && rm -rf ~/tempdir

cd $SCRIPT_DIR

# Clean up first
./clean_ipv6_nd_lib.sh

mkdir -p $SCRIPT_DIR/proto/

# Extract proto files associated with IPv6 ND Oper data

proto_archive_ipv6_nd="../../bigmuddy-network-telemetry-proto/proto_archive/"

for proto_folder in "${build_paths[@]}"
do
   cp -r ${proto_archive_ipv6_nd}/${proto_folder}/  ./proto/${proto_folder}
done

cp ${proto_archive_ipv6_nd}/telemetry.proto ./proto/


#Generate the c++ binding from proto files

<mark>$SCRIPT_DIR/gen-cpp-bindings-ipv6-nd.sh</mark>

# Compile the object files and build library
cd $SCRIPT_DIR/ipv6-nd-make
make

# Install the built xrtelemetry library
make install

</code></pre></p>


Notice the highlighted line above. It indicates that the script `build_ipv6_nd_lib.sh` invokes `gen-cpp-bindings-ipv6-nd.sh` which in turn creates the required bindings using `protoc`.
The contents of `gen-cpp-bindings-ipv6-nd.sh` are shown below to enable you to create your own build script for a different yang model(s) if needed.


```
admin@devbox:cpp$ pwd
/home/admin/telemetry-grpc-collectors/build/cpp
admin@devbox:cpp$
admin@devbox:cpp$ cat gen-cpp-bindings-ipv6-nd.sh
#!/bin/bash
#
# Copyright (c) 2016 by cisco Systems, Inc.
# All rights reserved.
#
set -x

if [ -d src/gen-ipv6-nd-obj ]; then
  rm -r src/gen-ipv6-nd-obj
fi

if [ -d src/gen-ipv6-nd-cpp ]; then
  rm -r src/gen-ipv6-nd-cpp
fi

mkdir -p src/gen-ipv6-nd-cpp
mkdir -p src/gen-ipv6-nd-obj
printf "Generating cplusplus bindings..."

cd ./proto/

for dir in `find . -type d -links 2`; do
  protoc -I ./  --grpc_out=../src/gen-ipv6-nd-cpp --plugin=protoc-gen-grpc=`which grpc_cpp_plugin` $dir/*.proto
  protoc -I ./ --cpp_out=../src/gen-ipv6-nd-cpp $dir/*.proto
  mkdir -p ../src/gen-ipv6-nd-obj/$dir
done

for file in .; do
  protoc -I ./  --grpc_out=../src/gen-ipv6-nd-cpp --plugin=protoc-gen-grpc=`which grpc_cpp_plugin` $file/*.proto
  protoc -I ./ --cpp_out=../src/gen-ipv6-nd-cpp $file/*.proto
done

echo "Done"
admin@devbox:cpp$
```


Great, now that we've understood how the build scripts work, let's execute `build_ipv6_nd_lib.sh`:

```
admin@devbox:cpp$
admin@devbox:cpp$ sudo ./build_ipv6_nd_lib.sh -p 3.5.0 -g 1.7.0
[sudo] password for admin:
Hit:1 http://us.archive.ubuntu.com/ubuntu xenial InRelease
Get:2 https://download.docker.com/linux/ubuntu xenial InRelease [66.2 kB]                                                                              
Get:3 http://us.archive.ubuntu.com/ubuntu xenial-updates InRelease [109 kB]                                                                                                              
Get:4 http://us.archive.ubuntu.com/ubuntu xenial-backports InRelease [107 kB]                                                                                                                       
Get:5 http://us.archive.ubuntu.com/ubuntu xenial-updates/main amd64 Packages [841 kB]                                                  
Get:6 http://us.archive.ubuntu.com/ubuntu xenial-updates/main i386 Packages [758 kB]                                                  
Get:7 http://us.archive.ubuntu.com/ubuntu xenial-updates/universe amd64 Packages [681 kB]           
Get:8 http://us.archive.ubuntu.com/ubuntu xenial-updates/universe i386 Packages [623 kB]        


........................ # SNIP OUTPUT #...........................  

a - ../src/gen-ipv6-nd-obj/cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/bundle_interfaces/bundle_interface/ipv6_nd_if_entry.grpc.pb.o
a - ../src/gen-ipv6-nd-obj/cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/bundle_nodes/bundle_node/ipv6_nd_bl_node_entry.grpc.pb.o
a - ../src/gen-ipv6-nd-obj/cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/bundle_nodes/bundle_node/ipv6_nd_bl_node_entry.pb.o
a - ../src/gen-ipv6-nd-obj/cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/nd_virtual_routers/nd_virtual_router/ipv6_nd_vr_entry.grpc.pb.o
a - ../src/gen-ipv6-nd-obj/cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/nd_virtual_routers/nd_virtual_router/ipv6_nd_vr_entry.pb.o
a - ../src/gen-ipv6-nd-obj/cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/interfaces/interface/ipv6_nd_if_params.grpc.pb.o
a - ../src/gen-ipv6-nd-obj/cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/interfaces/interface/ipv6_nd_if_params.pb.o
a - ../src/gen-ipv6-nd-obj/cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/neighbor_summary/ipv6_nd_neighbor_entry_summary.grpc.pb.o
a - ../src/gen-ipv6-nd-obj/cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/neighbor_summary/ipv6_nd_neighbor_entry_summary.pb.o
a - ../src/gen-ipv6-nd-obj/cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/neighbor_interfaces/neighbor_interface/host_addresses/host_address/ipv6_nd_neighbor_entry.grpc.pb.o
a - ../src/gen-ipv6-nd-obj/cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/neighbor_interfaces/neighbor_interface/host_addresses/host_address/ipv6_nd_neighbor_entry.pb.o
a - ../src/gen-ipv6-nd-obj/mdt_grpc_dialout/mdt_grpc_dialout.grpc.pb.o
a - ../src/gen-ipv6-nd-obj/mdt_grpc_dialout/mdt_grpc_dialout.pb.o
a - ../src/gen-ipv6-nd-obj/telemetry.pb.o
a - ../src/gen-ipv6-nd-obj/telemetry.grpc.pb.o
ranlib libxrtelemetry.a
mkdir -p /usr/local/include/xrtelemetry
cp -p libxrtelemetry.a  /usr/local/lib/
cd ../src/gen-ipv6-nd-cpp;cp -p --parents ./mdt_grpc_dialin/mdt_grpc_dialin.grpc.pb.h ./mdt_grpc_dialin/mdt_grpc_dialin.pb.h ./cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/bundle_interfaces/bundle_interface/ipv6_nd_if_entry.grpc.pb.h ./cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/bundle_interfaces/bundle_interface/ipv6_nd_if_entry.pb.h ./cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/bundle_nodes/bundle_node/ipv6_nd_bl_node_entry.grpc.pb.h ./cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/bundle_nodes/bundle_node/ipv6_nd_bl_node_entry.pb.h ./cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/nd_virtual_routers/nd_virtual_router/ipv6_nd_vr_entry.grpc.pb.h ./cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/nd_virtual_routers/nd_virtual_router/ipv6_nd_vr_entry.pb.h ./cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/interfaces/interface/ipv6_nd_if_params.grpc.pb.h ./cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/interfaces/interface/ipv6_nd_if_params.pb.h ./cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/neighbor_summary/ipv6_nd_neighbor_entry_summary.grpc.pb.h ./cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/neighbor_summary/ipv6_nd_neighbor_entry_summary.pb.h ./cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/neighbor_interfaces/neighbor_interface/host_addresses/host_address/ipv6_nd_neighbor_entry.grpc.pb.h ./cisco_ios_xr_ipv6_nd_oper/ipv6_node_discovery/nodes/node/neighbor_interfaces/neighbor_interface/host_addresses/host_address/ipv6_nd_neighbor_entry.pb.h ./mdt_grpc_dialout/mdt_grpc_dialout.grpc.pb.h ./mdt_grpc_dialout/mdt_grpc_dialout.pb.h  telemetry.pb.h telemetry.grpc.pb.h /usr/local/include/xrtelemetry

```

At the end of this script run, the required c++ bindings from the proto files have been generated and packaged into a single library called `libxrtelemetry`.
The `libxrtelemetry` library along with the grpc and protobuf libraries installed in the usual location for user libraries under `/usr/local/lib` and the header(.h) files under `/usr/local/include`


#### gRPC libraries

```
admin@devbox:cpp$ ls  -l /usr/local/lib/libgrpc*
-rwxr-xr-x 1 root root 2578912 Sep  3 18:21 /usr/local/lib/libgrpc.a
-rwxr-xr-x 1 root root 1226616 Sep  3 18:21 /usr/local/lib/libgrpc++.a
-rwxr-xr-x 1 root root 2231938 Sep  3 18:21 /usr/local/lib/libgrpc_cronet.a
-rwxr-xr-x 1 root root 2758912 Sep  3 18:21 /usr/local/lib/libgrpc++_cronet.a
lrwxrwxrwx 1 root root      23 Sep  3 18:21 /usr/local/lib/libgrpc_cronet.so -> libgrpc_cronet.so.5.0.0
lrwxrwxrwx 1 root root      25 Sep  3 18:21 /usr/local/lib/libgrpc++_cronet.so -> libgrpc++_cronet.so.1.7.0
lrwxrwxrwx 1 root root      21 Sep  3 18:21 /usr/local/lib/libgrpc++_cronet.so.1 -> libgrpc++_cronet.so.5
-rwxr-xr-x 1 root root 1075664 Sep  3 18:21 /usr/local/lib/libgrpc++_cronet.so.1.7.0
lrwxrwxrwx 1 root root      23 Sep  3 18:21 /usr/local/lib/libgrpc_cronet.so.5 -> libgrpc_cronet.so.5.0.0
lrwxrwxrwx 1 root root      25 Sep  3 18:21 /usr/local/lib/libgrpc++_cronet.so.5 -> libgrpc++_cronet.so.1.7.0
-rwxr-xr-x 1 root root  957992 Sep  3 18:21 /usr/local/lib/libgrpc_cronet.so.5.0.0
-rwxr-xr-x 1 root root  344440 Sep  3 18:21 /usr/local/lib/libgrpc++_error_details.a
lrwxrwxrwx 1 root root      32 Sep  3 18:21 /usr/local/lib/libgrpc++_error_details.so -> libgrpc++_error_details.so.1.7.0
lrwxrwxrwx 1 root root      28 Sep  3 18:21 /usr/local/lib/libgrpc++_error_details.so.1 -> libgrpc++_error_details.so.5
-rwxr-xr-x 1 root root   35432 Sep  3 18:21 /usr/local/lib/libgrpc++_error_details.so.1.7.0
lrwxrwxrwx 1 root root      32 Sep  3 18:21 /usr/local/lib/libgrpc++_error_details.so.5 -> libgrpc++_error_details.so.1.7.0
-rwxr-xr-x 1 root root  514720 Sep  3 18:21 /usr/local/lib/libgrpc++_reflection.a
lrwxrwxrwx 1 root root      29 Sep  3 18:21 /usr/local/lib/libgrpc++_reflection.so -> libgrpc++_reflection.so.1.7.0
lrwxrwxrwx 1 root root      25 Sep  3 18:21 /usr/local/lib/libgrpc++_reflection.so.1 -> libgrpc++_reflection.so.5
-rwxr-xr-x 1 root root  237184 Sep  3 18:21 /usr/local/lib/libgrpc++_reflection.so.1.7.0
lrwxrwxrwx 1 root root      29 Sep  3 18:21 /usr/local/lib/libgrpc++_reflection.so.5 -> libgrpc++_reflection.so.1.7.0
lrwxrwxrwx 1 root root      16 Sep  3 18:21 /usr/local/lib/libgrpc.so -> libgrpc.so.5.0.0
lrwxrwxrwx 1 root root      18 Sep  3 18:21 /usr/local/lib/libgrpc++.so -> libgrpc++.so.1.7.0
lrwxrwxrwx 1 root root      14 Sep  3 18:21 /usr/local/lib/libgrpc++.so.1 -> libgrpc++.so.5
-rwxr-xr-x 1 root root  344848 Sep  3 18:21 /usr/local/lib/libgrpc++.so.1.7.0
lrwxrwxrwx 1 root root      16 Sep  3 18:21 /usr/local/lib/libgrpc.so.5 -> libgrpc.so.5.0.0
lrwxrwxrwx 1 root root      18 Sep  3 18:21 /usr/local/lib/libgrpc++.so.5 -> libgrpc++.so.1.7.0
-rwxr-xr-x 1 root root 1151920 Sep  3 18:21 /usr/local/lib/libgrpc.so.5.0.0
-rwxr-xr-x 1 root root 2244556 Sep  3 18:21 /usr/local/lib/libgrpc_unsecure.a
-rwxr-xr-x 1 root root 1084898 Sep  3 18:21 /usr/local/lib/libgrpc++_unsecure.a
lrwxrwxrwx 1 root root      25 Sep  3 18:21 /usr/local/lib/libgrpc_unsecure.so -> libgrpc_unsecure.so.5.0.0
lrwxrwxrwx 1 root root      27 Sep  3 18:21 /usr/local/lib/libgrpc++_unsecure.so -> libgrpc++_unsecure.so.1.7.0
lrwxrwxrwx 1 root root      23 Sep  3 18:21 /usr/local/lib/libgrpc++_unsecure.so.1 -> libgrpc++_unsecure.so.5
-rwxr-xr-x 1 root root  295288 Sep  3 18:21 /usr/local/lib/libgrpc++_unsecure.so.1.7.0
lrwxrwxrwx 1 root root      25 Sep  3 18:21 /usr/local/lib/libgrpc_unsecure.so.5 -> libgrpc_unsecure.so.5.0.0
lrwxrwxrwx 1 root root      27 Sep  3 18:21 /usr/local/lib/libgrpc++_unsecure.so.5 -> libgrpc++_unsecure.so.1.7.0
-rwxr-xr-x 1 root root  997840 Sep  3 18:21 /usr/local/lib/libgrpc_unsecure.so.5.0.0
admin@devbox:cpp$
```  

#### Protobuf libraries

```
admin@devbox:cpp$ ls  -l /usr/local/lib/libproto*
-rw-r--r-- 1 root root  71115692 Sep  3 18:16 /usr/local/lib/libprotobuf.a
-rwxr-xr-x 1 root root       996 Sep  3 18:16 /usr/local/lib/libprotobuf.la
-rw-r--r-- 1 root root   8618058 Sep  3 18:16 /usr/local/lib/libprotobuf-lite.a
-rwxr-xr-x 1 root root      1031 Sep  3 18:16 /usr/local/lib/libprotobuf-lite.la
lrwxrwxrwx 1 root root        26 Sep  3 18:16 /usr/local/lib/libprotobuf-lite.so -> libprotobuf-lite.so.15.0.0
lrwxrwxrwx 1 root root        26 Sep  3 18:16 /usr/local/lib/libprotobuf-lite.so.15 -> libprotobuf-lite.so.15.0.0
-rwxr-xr-x 1 root root   3458816 Sep  3 18:16 /usr/local/lib/libprotobuf-lite.so.15.0.0
lrwxrwxrwx 1 root root        21 Sep  3 18:16 /usr/local/lib/libprotobuf.so -> libprotobuf.so.15.0.0
lrwxrwxrwx 1 root root        21 Sep  3 18:16 /usr/local/lib/libprotobuf.so.15 -> libprotobuf.so.15.0.0
-rwxr-xr-x 1 root root  27772608 Sep  3 18:16 /usr/local/lib/libprotobuf.so.15.0.0
-rw-r--r-- 1 root root 104925918 Sep  3 18:16 /usr/local/lib/libprotoc.a
-rwxr-xr-x 1 root root      1012 Sep  3 18:16 /usr/local/lib/libprotoc.la
lrwxrwxrwx 1 root root        19 Sep  3 18:16 /usr/local/lib/libprotoc.so -> libprotoc.so.15.0.0
lrwxrwxrwx 1 root root        19 Sep  3 18:16 /usr/local/lib/libprotoc.so.15 -> libprotoc.so.15.0.0
-rwxr-xr-x 1 root root  34287088 Sep  3 18:16 /usr/local/lib/libprotoc.so.15.0.0
admin@devbox:cpp$
admin@devbox:cpp$
```


### Verify Installed gRPC version

```
admin@devbox:cpp$ pkg-config --modversion grpc++
1.7.0
admin@devbox:cpp$

```

### Verify Installed Protobuf versions

```
admin@devbox:cpp$ pkg-config --modversion protobuf
3.5.0
admin@devbox:cpp$

```


#### User-Created xrtelemetry Library (contains the generated bindings)  

```
admin@devbox:cpp$
admin@devbox:cpp$ ls  -l /usr/local/lib/libxrtelemetr*
-rw-r--r-- 1 root root 15674258 Sep  3 18:22 /usr/local/lib/libxrtelemetry.a
admin@devbox:cpp$

```

#### User-Created xrtelemetry header Files

```
admin@devbox:cpp$ tree /usr/local/include/xrtelemetry/
/usr/local/include/xrtelemetry/
├── cisco_ios_xr_ipv6_nd_oper
│   └── ipv6_node_discovery
│       └── nodes
│           └── node
│               ├── bundle_interfaces
│               │   └── bundle_interface
│               │       ├── ipv6_nd_if_entry.grpc.pb.h
│               │       └── ipv6_nd_if_entry.pb.h
│               ├── bundle_nodes
│               │   └── bundle_node
│               │       ├── ipv6_nd_bl_node_entry.grpc.pb.h
│               │       └── ipv6_nd_bl_node_entry.pb.h
│               ├── interfaces
│               │   └── interface
│               │       ├── ipv6_nd_if_params.grpc.pb.h
│               │       └── ipv6_nd_if_params.pb.h
│               ├── nd_virtual_routers
│               │   └── nd_virtual_router
│               │       ├── ipv6_nd_vr_entry.grpc.pb.h
│               │       └── ipv6_nd_vr_entry.pb.h
│               ├── neighbor_interfaces
│               │   └── neighbor_interface
│               │       └── host_addresses
│               │           └── host_address
│               │               ├── ipv6_nd_neighbor_entry.grpc.pb.h
│               │               └── ipv6_nd_neighbor_entry.pb.h
│               └── neighbor_summary
│                   ├── ipv6_nd_neighbor_entry_summary.grpc.pb.h
│                   └── ipv6_nd_neighbor_entry_summary.pb.h
├── mdt_grpc_dialin
│   ├── mdt_grpc_dialin.grpc.pb.h
│   └── mdt_grpc_dialin.pb.h
├── mdt_grpc_dialout
│   ├── mdt_grpc_dialout.grpc.pb.h
│   └── mdt_grpc_dialout.pb.h
├── telemetry.grpc.pb.h
└── telemetry.pb.h

19 directories, 18 files
admin@devbox:cpp$

```


<p style="margin: 2em 0!important;padding: 1em;font-family: CiscoSans,Arial,Helvetica,sans-serif;font-size: 1em !important;text-indent: initial;background-color: #eff9ef;border-radius: 5px;box-shadow: 0 1px 1px rgba(0,127,171,0.25);"> Perfect! We are now ready to write our own c++ telemetry client/collector. The `xrtelemetry` library can be included into our client code to enable us to create telemetry subscriptions and decode data streamed to the client from the router.</p>
